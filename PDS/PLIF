*          DATA SET TSOPLIF    AT LEVEL 002 AS OF 11/12/80
PLIP     TITLE 'PLIF PROMPTER   DEFINITIONS'                            00001
         MACRO                                                          00002
&NAME    LDDN  &REG,&DD                                                 00003
&NAME    L     &REG,@DAIR28                                             00004
         L     &REG,DA28OPTR-DAPB28+(&DD-DDNAMES-2)/2(&REG)             00005
         MEND                                                           00006
         LCLC  &SYSOUT,&SYSDA                                           00007
*              DELETE THE FOLLOWING CARD IF DEFAULT TSO UNIT FOR        00008
*              SYSOUT DATA SETS IS DESIRED                              00009
&SYSOUT  SETC  'SYSDA'                                                  00010
*              DELETE THE FOLLOWING CARD IF DEFAULT  TSO  UNIT  FOR     00011
*              WORK DATASETS B     DESIRED                              00012
&SYSDA   SETC  'SYSDA'                                                  00013
FF       EQU   X'FF'                                                    00014
         TITLE 'PLIF PROMPTER   MAIN LINE'                              00015
PLIF     CSECT                                                          00016
         SAVE  (14,12),,PLIF-&SYSDATE-&SYSTIME                          00017
         LR    R12,R15        GET EPA                                   00018
         USING PLIF,R12                                                 00019
         GETMAIN              R,LV=WKAL    GETMAIN SOME CORE            00020
         ST    R1,8(13)                                                 00021
         ST    13,4(R1)                                                 00022
         LM    13,1,8(13)     GET ENTRY REGS BACK                       00023
         USING SAVE,13                                                  00024
         XC    SCRATCH(ENDSAVE-SCRATCH),SCRATCH                         00025
         SPACE 0                                                        00026
         LR    R11,R1         SAVE ENTRY REG                            00027
         USING CPPL,R11       TELL ASSEMBLER                            00028
         LA    R0,PARMS       INITIALIZE                                00029
         LA    R1,DDNAMES     PARMLIST                                  00030
         STM   R0,R1,PARMADDR                                           00031
         MVI   PARMADDR+4,X'80'     SIGNAL END OF LST                   00032
         SPACE 1                                                        00033
         LA    R0,SYSEND-DDNAMES-2   NUMBER OF DDNAMES                  00034
         STH   R0,DDNAMES                                               00035
         MVC   PARMS(3),=X'000040'  INITIALIZE LIST                     00036
         MVC   PARMS+3(251),PARMS+2     ALL BLANKS                      00037
         SPACE 1                                                        00038
*              INITIALIZE PUTLINE PARAMETER LIST                        00039
         LA    R1,PTPL                                                  00040
         USING IOPL,R1                                                  00041
         MVC   IOPLUPT,CPPLUPT                                          00042
         MVC   IOPLECT,CPPLECT                                          00043
         LA    R2,ECB                                                   00044
         ST    R2,IOPLECB                                               00045
         DROP  R1                                                       00046
         MVI   SPMAC,MIX                                                00047
         MVI   SPMD,MIX                                                 00048
         MVI   SPLIB,MIX                                                00049
         MVI   SPD,NO                                                   00050
         BALR  R12,0          GET A BASE                                00051
         USING *,R12          TELL ASSEMBLER                            00052
         EJECT                                                          00053
*              BUILD PARSE LIST                                         00054
         LA    R1,PARSEPL                                               00055
         USING PPL,R1                                                   00056
         MVC   PPLUPT,CPPLUPT  UPT                                      00057
         MVC   PPLECT,CPPLECT                                           00058
         LA    R2,ECB                                                   00059
         ST    R2,PPLECB      ECB                                       00060
         L     R9,=A(PLIFPARM)                                          00061
         ST    R9,PPLPCL      PCL                                       00062
         MVC   PPLCBUF,CPPLCBUF                                         00063
         LA    R3,@PDE                                                  00064
         ST    R3,PPLANS                                                00065
         LINK  EP=IKJPARS                                               00066
         LTR   R15,R15                                                  00067
         BZ    PLIF2                                                    00068
         BAL   R14,FAIL                                                 00069
PLIF2    EQU   *                                                        00070
         USING PLIFPARM,R9                                              00071
         L     R10,@PDE       GET THE PDE                               00072
         USING PDL,R10                                                  00073
         DROP  R1                                                       00074
         LA    R1,PCEFIRST                                              00075
         BAL   R14,EASYKEY    GO DO THEEASY ONES                        00076
*              INITIALIZE THE SUBFIELD PARMS                            00077
SFIA     TM    SIZE+6,X'80'   SIZE PRESENT?                             00078
         BZ    SFIB           NO TRY NEXT                               00079
         LA    R1,=C'SIZE='                                             00080
         LA    R2,4                                                     00081
         BAL   R14,APEND                                                00082
         L     R1,SIZE        ADDR                                      00083
         LH    R2,SIZE+4      LENGTH                                    00084
         BCTR  R2,0           -1                                        00085
         BAL   R14,APENDC     ADD THE VALUE WITHOUT COMMA               00086
         SPACE 1                                                        00087
SFIB     TM    OPT+6,X'80'    OPT SPECIFIED                             00088
         BZ    SFIC           NO TRY NEXT                               00089
         LA    R1,=C'OPT='                                              00090
         LA    R2,3                                                     00091
         BAL   R14,APEND                                                00092
         L     R1,OPT                                                   00093
         LH    R2,OPT+4                                                 00094
         BCTR  R2,0                                                     00095
         BAL   R14,APENDC                                               00096
         SPACE 1                                                        00097
SFIC     TM    OBJNM+6,X'80'    OBJNAME?                                00098
         BZ    SFID           NO                                        00099
         LA    R1,=C'N='                                                00100
         LA    R2,1                                                     00101
         BAL   R14,APEND                                                00102
         L     R1,OBJNM                                                 00103
         LH    R2,OBJNM+4                                               00104
         BCTR  R2,0                                                     00105
         BAL   R14,APENDC                                               00106
         SPACE 1                                                        00107
SFID     TM    SM1+6,X'80'    SORMGIN                                   00108
         BZ    SFIE           NO                                        00109
         LA    R1,=C'SM=('                                              00110
         LA    R2,3                                                     00111
         BAL   R14,APEND                                                00112
         L     R1,SM1                                                   00113
         LH    R2,SM1+4                                                 00114
         BCTR  R2,0                                                     00115
         BAL   R14,APENDC                                               00116
         L     R1,SM2                                                   00117
         LH    R2,SM2+4                                                 00118
         BCTR  R2,0                                                     00119
         BAL   R14,APEND      NEED COMMA THIS TIME                      00120
         TM    SM3+6,X'80'    GET THE THIRD PARM                        00121
         BZ    SFID2          NO                                        00122
         L     R1,SM3                                                   00123
         LH    R2,SM3+4                                                 00124
         BCTR  R2,0                                                     00125
         BAL   R14,APEND                                                00126
SFID2    DS    0H                                                       00127
         LA    R1,=C')'                                                 00128
         LA    R2,0                                                     00129
         BAL   R14,APENDC                                               00130
         SPACE 1                                                        00131
SFIE     TM    LINECNT+6,X'80'                                          00132
         BZ    SFIF                                                     00133
         LA    R1,=C'LC='                                               00134
         LA    R2,2                                                     00135
         BAL   R14,APEND                                                00136
         L     R1,LINECNT                                               00137
         LH    R2,LINECNT+4                                             00138
         BCTR  R2,0                                                     00139
         BAL   R14,APENDC                                               00140
SFIF     CLI   MACDCK+1,0     DID HE SPECIFY A PREF                     00141
         BZ    SFIG           NO                                        00142
         CLI   MACDCK+1,2                                               00143
         BH    SFIF3          HE DOESN'T WANT IT                        00144
         MVI   SPMD,YES                                                 00145
         LA    R1,=C'MD'                                                00146
         LA    R2,1                                                     00147
         B     SFIF4                                                    00148
         SPACE 1                                                        00149
SFIF3    MVI   SPMD,NO                                                  00150
         LA    R1,=C'NMD'                                               00151
         LA    R2,2                                                     00152
SFIF4    BAL   R14,APEND                                                00153
         SPACE 1                                                        00154
SFIG     CLI   MACRO+1,0      DID HE SPECIFY MACRO                      00155
         BZ    SFIG3          NO                                        00156
         CLI   MACRO+1,2      EXCLUDE IT                                00157
         BH    SFIG2          YES                                       00158
         MVI   SPMAC,YES      HE WANTS IT                               00159
         B     SFIH                                                     00160
SFIG2    MVI   SPMAC,NO       DOESN'T WANT IT                           00161
         B     SFIH                                                     00162
         SPACE 1                                                        00163
SFIG3    TM    SPMD,YES       DOESN'T CARE DID HE ASKF OF DECK          00164
         BNO   SFIH           NO                                        00165
         LA    R1,=C'MACRO'   THEN FORCE MACRO                          00166
         LA    R2,4                                                     00167
         BAL   R14,APEND                                                00168
         MVI   SPMAC,YES                                                00169
         SPACE 2                                                        00170
SFIH     DS    0H                                                       00171
         EJECT                                                          00172
*              INITIALIZE ALL DAIR BLOCKS                               00173
         LA    R1,DAIRPL                                                00174
         BAL   R14,BUILDAIR                                             00175
         SPACE 4                                                        00176
*              BEGIN ALLOCATION                                         00177
ALCIN    LDDN  R9,SYSIN                                                 00178
         USING DAPB08,R9      R9=DAPB08                                 00179
         MVC   DA08CD,=X'0008'      SET ALLOCAT CODE                    00180
         LA    R1,=C'PLI'     QUALIFIER                                 00181
         LA    R2,3           LENGTH                                    00182
         LA    R3,DSIN        PDE                                       00183
         BAL   R14,BUILDDSN                                             00184
         B     *+4(R15)                                                 00185
         B     ALCIN3         RC=0 HAVE SIMPLE                          00186
         B     ALCIN4         RC=4 NOT SIMPLE                           00187
         B     ALCIN7         RC=8 ALLOCATE TO TERM                     00188
         SPACE 1                                                        00189
ALCIN3   LM    R5,R6,DSIN     SAVE SIMPLE NAME AND LENGTH               00190
         B     ALCIN4B                                                  00191
*              USER MEMBER NAME FOR SIMPLE NAME                         00192
         SPACE 1                                                        00193
ALCIN4   LM    R5,R6,DSIN+8   USE MEMBER NAME FOR SIMPLE                00194
ALCIN4B  STM   R5,R6,SIMPLE   FOR POSSIBLE USE LATER                    00195
ALCIN5   OI    DA08DSP1,DA08SHR    FLAG SHARE                           00196
ALCIN7   DS    0H                                                       00197
         SPACE 4                                                        00198
*              SYSLIB ALLOCATION                                        00199
ALCLIB   TM    SPMAC,YES                                                00200
         BNO   ALCLIB3        BRANCH IF NOT SPECIFIED                   00201
         CLI   LIB+1,0        LIB PARM SPECIFIED                        00202
         BNZ   ALCLIB5        YEAH HE SPECIFIED IT                      00203
         PUTLINE PARM=MSG001,MF=(E,PTPL)  LIB REQUIRED IF MACRO SP      00204
         B QUIT                                                         00205
         SPACE 1                                                        00206
ALCLIB3  BM    ALCLIB4        DOESN'T CARE                              00207
         CLI   LIB+1,0        LPECIFY LIB                               00208
         BZ    ALCLIB9        NO                                        00209
         PUTLINE  PARM=MSG002,MF=(E,PTPL)  LIB AND NOMACRO SPECIFED     00210
         B     QUIT                                                     00211
*                                                                       00212
ALCLIB4  CLI   LIB+1,0        NO LIB SPEC                               00213
         BZ    ALCLIB9                                                  00214
         LA    R1,=C'MACRO'   SPECIFY MACRO SINCE HE SP LIB             00215
         LA    R2,4                                                     00216
         BAL   R14,APEND                                                00217
         MVI   SPMAC,YES                                                00218
*                                                                       00219
ALCLIB5  LDDN  R9,SYSLIB                                                00220
         USING DAPB08,R9      R9 = DAIR BLOCK                           00221
         LA    R3,DSLIB                                                 00222
         LA    R1,BLANKS      NO QUALIFIER                              00223
         LA    R2,0                                                     00224
         BAL   R14,BUILDDSN   MOVE IN DSN STUFF                         00225
         MVC   DA08CD,=X'0008'                                          00226
         OI    DA08DSP1,DA08SHR    FLAG SHARE                           00227
         CLI   24(R3),FF      END OF LIST                               00228
         BE    ALCLIB9                                                  00229
         LDDN  R9,SYSLIB2     NO GET LIB 2                              00230
         L     R3,24(R3)      NEXT                                      00231
         BAL   R14,BUILDDSN                                             00232
         MVC   DA08CD,=X'0008'                                          00233
         OI    DA08DSP1,DA08SHR                                         00234
         SPACE                                                          00235
         CLI   24(R3),FF      END OF LIST YET?                          00236
         BE    ALCLIB9        YUP                                       00237
         LDDN  R9,SYSLIB3     GET LIB 3                                 00238
         L     R3,24(R3)      NEXT                                      00239
         BAL   R14,BUILDDSN                                             00240
         MVC   DA08CD,=X'0008'                                          00241
         OI    DA08DSP1,DA08SHR                                         00242
         SPACE 1                                                        00243
         CLI   24(R3),FF      END OF LIST YET?                          00244
         BE    ALCLIB9        YUP                                       00245
         PUTLINE  PARM=MSG009,MF=(E,PTPL)  TOO MAN Y  LIBS              00246
         B     QUIT                                                     00247
ALCLIB9  DS    0H                                                       00248
         EJECT                                                          00249
ALCPRNT  LDDN  R9,SYSPRINT    ALLOCATE SYSPRINT DATASET                 00250
         USING DAPB08,R9                                                00251
         CLI   PRINT+1,1      DSN SPECIFIED                             00252
         BE    ALCPRNT3       YES                                       00253
*              ALLOCATE TO SYSOUT                                       00254
         USING DAPB30,R9                                                00255
         XC    DAPB30(64),DAPB30   CLEAR WHOLE BLOCK                    00256
         MVC   DA30CD,=X'0030'     SYSOUT CALL                          00257
         MVC   DA30DDN,BLANKS                                           00258
         MVC   DA30UNIT,=CL8'&SYSOUT.'                                  00259
         MVC   DA30SER,BLANKS                                           00260
         LA    R0,0           BLKSIZE                                   00261
         LA    R1,50          DEFAULT   50 TRACKS                       00262
         LA    R2,10          10 SECONDARY                              00263
         STM   R0,R2,DA30BLK PQTY SQTY                                  00264
         MVC   DA30PGNM,BLANKS                                          00265
         MVC   DA30FORM,BLANKS                                          00266
         TM    SYSOUTAP+6,X'80'    PROGRAM NAME SPC                     00267
         BZ    ALCPRNT1       NO                                        00268
         L     R5,SYSOUTAP    PROGRAM NAME                              00269
         LH    R6,SYSOUTAP+4                                            00270
         BCTR  R6,0           -1                                        00271
         EX    R6,*+4                                                   00272
         MVC   DA30PGNM(1),0(R5)                                        00273
         SPACE 1                                                        00274
ALCPRNT1 TM    SYSOUTAF+6,X'80'    FORM SPECIFIED                       00275
         BZ    ALCPRNT2                                                 00276
         L     R5,SYSOUTAF                                              00277
         LH    R6,SYSOUTAF+4                                            00278
         BCTR  R6,0                                                     00279
         EX    R6,*+4                                                   00280
         MVC   DA30FORM(1),0(R5)    FORM NUMBER                         00281
         SPACE 1                                                        00282
ALCPRNT2 DS    0H                                                       00283
         L     R5,SYSOUTA                                               00284
         MVC   DA30OCLS(1),0(R5)                                        00285
         MVI   DA30OCLS+1,C' '                                          00286
         MVC   AOUT,0(R5)     SAVE OUTPUT CLASS FOR FREE                00287
         MVI   DA30CTL,DA30TRKS                                         00288
         B     ALCPRNT9                                                 00289
         SPACE 1                                                        00290
         USING DAPB08,R9                                                00291
ALCPRNT3 TM    DSPRINT+6,X'80'     DSNAME SPECIFIED                     00292
         BO    ALCPRNT5       YEAH                                      00293
         LM    R5,R6,SIMPLE   GET THE SIMPLE QUALIFIER                  00294
         LTR   R6,R6          ANY                                       00295
         BNZ   ALCPRNT4       YUP                                       00296
         PUTLINE  PARM=MSG004,MF=(E,PTPL) MUST HAVE DSNAME              00297
         B QUIT                                                         00298
         SPACE 1                                                        00299
ALCPRNT4 STM   R5,R6,DSPRINT                                            00300
ALCPRNT5 LA    R1,=C'LIST'    QUALIFIER                                 00301
         LA    R2,4           LENGTH                                    00302
         LA    R3,DSPRINT                                               00303
         BAL   R14,BUILDDSN                                             00304
         B     *+4(R15)                                                 00305
         B     ALCPRNT6       RC=0                                      00306
         B     ALCPRNT6       RC=4                                      00307
         B     ALCPRNT9       RC=8 TERMINAL WAS ALLOCATED               00308
ALCPRNT6 BAL   R14,OLDNEW     FIND OUT IF IT ALREADY EXISTS             00309
         TM    DA08DSP1,DA08NEW  IF NEW                                 00310
         BZ    ALCPRNT7       BUT ITS NOT                               00311
         LA    R0,0           SPECIFY SPACE PARMS                       00312
         LA    R1,50          PQTY  50 TRKS                             00313
         LA    R2,10          SECONDARY                                 00314
         SR    R3,R3          NO DIRECTORY                              00315
         CLC   DA08MNM,BLANKS OR IS THERE?                              00316
         BE    *+8                                                      00317
         LA    R3,3           THEN SPECIFY 3 BLOCKS                     00318
         STM   R0,R3,DA08BLK PQTY SQTY DBLKS                            00319
         OI    DA08CTL,DA08TRKS+DA08RLSE                                00320
ALCPRNT7 DS    0H                                                       00321
ALCPRNT9 DS    0H                                                       00322
         EJECT                                                          00323
ALCGO    CLI   LOAD+1,2       NO LOAD                                   00324
         BH    ALCGO7         NO                                        00325
         LA    R1,=C'LOAD'                                              00326
         LA    R2,3                                                     00327
         BAL   R14,APEND      SPECIFY PARAMETER                         00328
         TM    DSGO+6,X'80'   SPECIFY A DSNAME                          00329
         BO    ALCGO4         YEAH                                      00330
         LM    R5,R6,SIMPLE                                             00331
         LTR   R6,R6                                                    00332
         BNZ   ALCGO3                                                   00333
         PUTLINE  PARM=MSG003,MF=(E,PTPL) NAME MUST BE SPEC             00334
         B QUIT                                                         00335
         SPACE 1                                                        00336
ALCGO3   STM   R5,R6,DSGO                                               00337
ALCGO4   LA    R1,=C'OBJ'     DEFAULT NAME                              00338
         LA    R2,3                                                     00339
         LA    R3,DSGO                                                  00340
         LDDN  R9,SYSLIN                                                00341
         BAL   R14,BUILDDSN   BUILD THE DSNAME                          00342
         BAL   R14,OLDNEW                                               00343
         TM    DA08DSP1,DA08NEW     IS IT NEW                           00344
         BZ    ALCGO6         IF NO                                     00345
         LA    R0,400         SET SPACE PARAMETERS                      00346
         LA    R1,200         PRI QTY                                   00347
         LA    R2,100         SEC QTY                                   00348
         STM   R0,R2,DA08BLK PQTY SQTY                                  00349
         CLC   DA08MNM,BLANKS MEMBER SPECIFIED                          00350
         BE    ALCGO5         NO                                        00351
         LA    R3,3           DIRECTORY QUANTITY                        00352
         ST    R3,DA08DQTY                                              00353
ALCGO5   OI    DA08CTL,DA08ABKL    AVERAGE BLOCK LENGT                  00354
ALCGO6   B     ALCGO9                                                   00355
ALCGO7   DS    0H             NOLOAD SPEC                               00356
         LA    R1,=C'NOLOAD'                                            00357
         LA    R2,5                                                     00358
         BAL   R14,APEND                                                00359
ALCGO9   DS    0H                                                       00360
         EJECT                                                          00361
ALCPNCH  TM    SPMD,YES                                                 00362
         BNO   ALCPNCH1                                                 00363
         MVI   SPD,YES        FLAG WE NEED A DECK                       00364
ALCPNCH1 LH    R15,PUNCH                                                00365
         SLL   R15,2          OPTION * 4                                00366
         B     *+4(R15)                                                 00367
         B     ALCPNCH6       O    NOTHING SPECIFIED                    00368
         B     ALCPNCH3       1    DECK                                 00369
         B     ALCPNCH3       2    DECK                                 00370
         B     ALCPNCH4       3    NODECK                               00371
         B     ALCPNCH4       4    ND                                   00372
*        B     *+4            5    SYSPUNCH                             00373
         TM    SPMD,YES       IF MACRO SPEC DON'T FORCE DECK            00374
         BO    ALCPNCH6                                                 00375
ALCPNCH3 LA    R1,=C'DECK'                                              00376
         LA    R2,3                                                     00377
         MVI   SPD,YES        DECK SPECIFIED                            00378
         B     ALCPNCH5                                                 00379
         SPACE 1                                                        00380
ALCPNCH4 LA    R1,=C'NODECK'                                            00381
         LA    R2,5                                                     00382
ALCPNCH5 BAL   R14,APEND                                                00383
ALCPNCH6 TM    SPD,YES        NEED SYSPUNCH                             00384
         BNO   ALCPNCHZ       NO                                        00385
         LDDN  R9,SYSPUNCH                                              00386
         USING DAPB08,R9                                                00387
         MVC   DA08CD,=X'0008'                                          00388
*              MAKE SURE WE DON'T HAVE BOTH SYSOUT AND DS               00389
         TM    DSPUNCH+6,X'80'                                          00390
         BZ    ALCPNCH7                                                 00391
         TM    SYSOUTB+6,X'80'                                          00392
         BZ    ALCPNCHA       GO DO DSNAME                              00393
         PUTLINE  PARM=MSG005,MF=(E,PTPL)                               00394
         B     QUIT                                                     00395
         SPACE 1                                                        00396
ALCPNCH7 TM    SYSOUTB+6,X'80'     SYSOUT                               00397
         BZ    ALCPNCH8       NO FORCE DSNAME                           00398
         USING DAPB30,R9                                                00399
         XC    DAPB30(64),DAPB30   CLEAR IT                             00400
         MVC   DA30CD,=X'0030'     ALLOCATE SYSOUT                      00401
         MVC   DA30DDN,BLANKS                                           00402
         MVC   DA30UNIT,=CL8'&SYSOUT.'                                  00403
         MVC   DA30SER,BLANKS                                           00404
         LA    R0,0                                                     00405
         LA    R1,50          PRI QTY                                   00406
         LA    R2,10          SEC                                       00407
         STM   R0,R2,DA30BLK PQTY SQTY                                  00408
         MVC   DA30PGNM,BLANKS                                          00409
         MVC   DA30FORM,BLANKS                                          00410
         TM    SYSOUTBP+6,X'80'  PROGRAM NAME SPEC                      00411
         BZ    ALCPCH7E       NO                                        00412
         L     R5,SYSOUTBP                                              00413
         LH    R6,SYSOUTBP+4                                            00414
         BCTR  R6,0                                                     00415
         EX    R6,*+4                                                   00416
         MVC   DA30PGNM(1),0(R5)                                        00417
ALCPCH7E TM    SYSOUTBF+6,X'80'    FORM SPEC                            00418
         BZ    ALCPCH7G                                                 00419
         L     R5,SYSOUTBF                                              00420
         LH    R6,SYSOUTAF+4                                            00421
         BCTR  R6,0                                                     00422
         EX    R6,*+4                                                   00423
         MVC   DA30FORM(1),0(R5)                                        00424
         SPACE 1                                                        00425
ALCPCH7G DS    0H                                                       00426
         L     R5,SYSOUTB                                               00427
         MVC   DA30OCLS(1),0(R5)                                        00428
         MVI   DA30OCLS+1,C' '                                          00429
         MVC   BOUT,0(R5)                                               00430
         MVI   DA30CTL,DA30TRKS                                         00431
         B     ALCPNCHZ                                                 00432
         SPACE 1                                                        00433
         USING DAPB08,R9                                                00434
ALCPNCH8 DS    0H             NO NOTHINE                                00435
         LM    R5,R6,SIMPLE   HAVE A SIMPLE NAME                        00436
         LTR   R6,R6          HAVE ONE                                  00437
         BNZ   ALCPNCH9  YEAH                                           00438
         PUTLINE  PARM=MSG006,MF=(E,PTPL)  MUST HAVE NAME               00439
         B     QUIT                                                     00440
         SPACE 1                                                        00441
ALCPNCH9 STM   R5,R6,DSPUNCH                                            00442
ALCPNCHA LA    R3,DSPUNCH                                               00443
         LA    R2,4                                                     00444
         LA    R1,=C'DECK'                                              00445
         BAL   R14,BUILDDSN                                             00446
         BAL   R14,OLDNEW                                               00447
         TM    DA08DSP1,DA08NEW    IS IT NEW                            00448
         BZ    ALCPNCHB        NO                                       00449
         LA    R0,400         YES  SET BLOCK SIZE                       00450
         LA    R1,200         PRI QTY                                   00451
         LA    R2,100         SEC                                       00452
         SR    R3,R3                                                    00453
         CLC   DA08MNM,BLANKS MEMBER NAME                               00454
         BE    *+8                                                      00455
         LA    R3,3           IF SO 3 DIRECTORY BLOCKS                  00456
         STM   R0,R3,DA08BLK                                            00457
         OI    DA08CTL,DA08ABKL                                         00458
ALCPNCHB  DS    0H                                                      00459
ALCPNCHZ DS    0H                                                       00460
         EJECT                                                          00461
ALCUT1   LDDN  R9,SYSUT1                                                00462
         USING DAPB08,R9                                                00463
         MVC   DA08CD,=X'0008'                                          00464
         L     R7,DA08PDSN                                              00465
         USING DSNBUF,R7                                                00466
         MVC   DSNAME(7),=C'&&SYSUT1'                                   00467
         MVC   DA08UNIT,=CL8'&SYSDA.'                                   00468
         LA    R2,7                                                     00469
         STH   R2,DSLENG                                                00470
         DROP  R7                                                       00471
         LA    R0,1024        BLKSIZE                                   00472
         LA    R1,250                                                   00473
         LA    R2,50                                                    00474
         STM   R0,R2,DA08BLK  PQTY SQTY                                 00475
         OI    DA08DSP1,DA08NEW                                         00476
         OI    DA08DPS2,DA08DEL                                         00477
         OI    DA08CTL,DA08ABKL                                         00478
         SPACE 2                                                        00479
ALCUT3   TM    SPMAC,YES                                                00480
         BO    ALCUT31        IF MACRO WE NEED IT                       00481
         CLI   CHAR+1,1       OR                                        00482
        BE       ALCUT31              CHAR48                            00483
         CLI   CHAR+1,2                                                 00484
         BNE   ALCUT3Z        DON'T NEED IT                             00485
ALCUT31  LDDN  R9,SYSUT3                                                00486
         USING DAPB08,R9                                                00487
         MVC   DA08CD,=X'0008'                                          00488
         LA    R0,80                                                    00489
         LA    R1,500                                                   00490
         LA    R2,250                                                   00491
         STM   R0,R2,DA08BLK  SPACE PARMS                               00492
         OI    DA08DSP1,DA08NEW                                         00493
         OI    DA08DPS2,DA08DEL                                         00494
         OI    DA08CTL,DA08ABKL                                         00495
         L     R7,DA08PDSN                                              00496
         USING DSNBUF,R7                                                00497
         LA    R2,7                                                     00498
         STH   R2,DSLENG                                                00499
         MVC   DSNAME(7),=C'&&SYSUT3'                                   00500
         MVC   DA08UNIT,=CL8'&SYSDA.'                                   00501
         DROP  R7                                                       00502
ALCUT3Z  DS    0H                                                       00503
         TITLE 'PLIF PROMPTER  MAIN LINE  CALL TO DAIR'                 00504
         IKJRLSA @PDE     RELEASE ALL THE PDE SPACE                     00505
         SPACE 2                                                        00506
DAIR1    L     R7,@DAIR28     MULTIPLE CALL BLOCK                       00507
         USING DAPB28,R7                                                00508
         LA    R1,DAIRPL                                                00509
         USING DAPL,R1                                                  00510
         ST    R7,DAPLDAPB    FILL IN ADDRESS                           00511
         LINK  EP=IKJEFD00    CALL DAIR                                 00512
         LTR   R15,R15        ANY  ERROR?                               00513
         BZ    DAIR6          NO   ERRORS                               00514
DAIR3    MVC   DAPLDAPB,DA28PFOP   MOVE IN FAILING OP                   00515
DAIR4    DS    0H             OLDNEW JUMPS IN HERE                      00516
         ST    R15,SCRATCH    NEED RETRUN CODE FOR DAIRFAIL             00517
         LINK  EP=IKJEFF18,PARAM=(DAIRPL,SCRATCH,=A(0),=H'1'),         *00518
               MF=(E,PARSEPL) USE PARSE PARAM LIST FOR DAIR FAIL        00519
         B     QUIT                                                     00520
DAIR6    DS    0H                                                       00521
         BAL   R14,SETDDNAM   GO BUILD DDNAME TABLE                     00522
         SPACE 2                                                        00523
*                             CHECK FOR MULTI LIB                       00524
         NC    SYSLIB2,SYSLIB2                                          00525
         BZ    DAIR7          NO SWEAT                                  00526
         LDDN  R7,SYSLIN      GET ANY DAIR BLOCK                        00527
         USING DAPB0C,R7                                                00528
         XC    DAPB0C(36),DAPB0C                                        00529
         MVC   DA0CCD,=X'000C'                                          00530
         LA    R2,2                                                     00531
         MVC   DA0CDDN,SYSLIB                                           00532
         MVC   DA0CDDN+8,SYSLIB2                                        00533
         NC    SYSLIB3,SYSLIB3     3?                                   00534
         BZ    DAIR6F         NO                                        00535
         LA    R2,3                                                     00536
         MVC   DA0CDDN+16,SYSLIB3                                       00537
DAIR6F   STH   R2,DA0CNUMB                                              00538
         ST    R7,DAPLDAPB                                              00539
         LINK  EP=IKJEFD00                                              00540
         LTR   R15,R15                                                  00541
         BNZ   DAIR4                                                    00542
         XC    SYSLIB2,SYSLIB2                                          00543
         XC    SYSLIB3,SYSLIB3                                          00544
DAIR7    DS    0H                                                       00545
DAIR8    DS    0H                                                       00546
         BAL   R14,FREEDAIR   CLEAN UP                                  00547
         TITLE 'PLIF PROMPTER  MAIN LINE  CALL TO COMPILER'             00548
LINK     DS    0H                                                       00549
LINK1    DS    0H                                                       00550
         LA    R1,2           2 SEGMENTS                                00551
         LA    R2,MSG007      MESSAGE                                   00552
         LA    R3,PARMS-2     SECOND HALF OF MESSAGE                    00553
         STM   R1,R3,PARSEPL  USE PARSE LIST FOR OLD                    00554
         LH    R2,PARMS       SAVE LENGTH                               00555
         LA    R0,L'MSG007T                                             00556
         STH   R0,PARMS                                                 00557
         LA    R0,4(R2)                                                 00558
         STH   R0,PARMS-2                                               00559
         PUTLINE  PARM=DAIR04,OUTPUT=(PARSEPL,TERM,SINGLE,INFOR),      *00560
               TERMPUT=(EDIT,WAIT,NOHOLD,NOBREAK),MF=(E,PTPL)           00561
         SPACE 1                                                        00562
LINK3    STH   R2,PARMS       MOVE LENGTH BACK                          00563
         SPACE 4                                                        00564
         LA    R1,PARMADDR                                              00565
         LINK  EP=IEMAA                                                 00566
         ST    R15,RETCODE                                              00567
LINKRET  LTR   R15,R15        ANY ERROR CODE                            00568
         BZ    CLEANUP        ONLY GIVE BAD NEWS!                       00569
         LA    R2,MSG008      MOST OF BLOCKS ARE STILL SETUP            00570
         ST    R2,PARSEPL+4   OLD  ALREADY BUILT                        00571
         CVD   R15,SCRATCH                                              00572
         OI    SCRATCH+7,15                                             00573
         UNPK  PARMS+2(2),SCRATCH  RETURN CODE                          00574
         LA    R0,6                                                     00575
         STH   R0,PARMS-2     WHOLE THING IS 6 BYTES LONG               00576
         LA    R0,L'MSG008T                                             00577
         STH   R0,PARMS                                                 00578
         PUTLINE              MF=(E,PTPL)                               00579
         TITLE   'PLIF PROMPTER   MAIN LINE      CLEANUP'               00580
CLEANUP  CLI   AOUT,0         ANY SYSPRINT                              00581
         BZ    CLUP5          NO                                        00582
         IC    R0,AOUT                                                  00583
         LA    R1,SYSPRINT                                              00584
         BAL   R14,FREEDS     FREE IT                                   00585
CLUP5    CLI   BOUT,0         ANY PUNCH                                 00586
         BZ    CLUP9          NO                                        00587
         IC    R0,BOUT                                                  00588
         LA    R1,SYSPUNCH                                              00589
         BAL   R14,FREEDS                                               00590
CLUP9    DS    0H                                                       00591
         B     EXIT                                                     00592
         TITLE 'FREEDS    FREE A SYSOUT DATASET'                        00593
FREEDS   SAVE     (14,12)                                               00594
         LR    R6,R14         SAVE RETURN                               00595
         GETMAIN              R,LV=40                                   00596
         LR    R9,R1                                                    00597
         USING DAPB18,R9      FREE DS BLOCK                             00598
         XC    DAPB18(40),DAPB18                                        00599
         LM    R0,R1,SAVE+20  GET R0 AND R1 BACK                        00600
         MVC   DA18CD,=X'0018'     SET CODE                             00601
         MVC   DA18DDN,0(R1)  DDNAME                                    00602
         MVC   DA18MNM,BLANKS                                           00603
         MVC   DA18SCLS,BLANKS                                          00604
         STC   R0,DA18SCLS                                              00605
         MVC   DA18JBNM,BLANKS                                          00606
         SPACE 1                                                        00607
         LA    R1,DAIRPL                                                00608
         USING DAPL,R1                                                  00609
         ST    R9,DAPLDAPB                                              00610
         LINK  EP=IKJDAIR                                               00611
         LTR   R15,R15        ANY ERROR                                 00612
         BNZ   DAIR4          YUP LET INLINE DIAGNOSE IT                00613
         FREEMAIN     R,LV=40,A=(R9)                                    00614
         DROP  R9,R1                                                    00615
         BR    R6             RETURN                                    00616
         TITLE 'BUILD DSNAME PARM'                                      00617
*                             R9 = DAPB08                               00618
*                             R3 = PDE FOR DSNAME                       00619
*                             R2 = L'QUAL                               00620
*                             R1 = QUAL                                 00621
*                                                                       00622
*                             RC=4 NO SIMPLE NAME                       00623
*                             RC=8 TERMINAL                             00624
BUILDDSN SAVE  (14,12)                                                  00625
         USING DAPB08,R9                                                00626
         MVC   DA08CD,=X'0008'                                          00627
         SR    R15,R15        PRESER RETURNCODE                         00628
         L     R7,DA08PDSN                                              00629
         USING DSNBUF,R7                                                00630
         TM    6(R3),X'80'    DSNAME MISSING                            00631
         BO    BUIDD3         NO                                        00632
         STH   R2,DSLENG                                                00633
         BCTR  R2,0           -1                                        00634
         EX    R2,*+4                                                   00635
         MVC   DSNAME(1),0(R1)     JUST A QUALIFIER                     00636
         LA    R15,4          RC=4                                      00637
         B     BUIDD4C                                                  00638
         SPACE 1                                                        00639
BUIDD3   L     R5,0(R3)       SUPPLIED DDNAME                           00640
         LH    R6,4(R3)       LENGTH                                    00641
         CH    R6,=H'1'       LENGTH OF ONE                             00642
         BNE   BUIDD4                                                   00643
         CLI   0(R5),C'*'     AND * MEANS TERMINAL ALLOCATE             00644
         BNE   BUIDD4         NO                                        00645
*                             WIPE OUT BLOCK TO ALLOCATE TERM           00646
         USING DAPB1C,R9      TELL ASSEMBLER                            00647
         MVC   DA1CCD,=X'001C'     TERMINAL ALLOCATE CODE               00648
         MVI   DA1CCTL,0                                                00649
         MVC   DA1CDDN,BLANKS ANY NAME                                  00650
         RETURN  (14,12),RC=8                                           00651
         SPACE 1                                                        00652
         USING DAPB08,R9      BACK TO USUAL CONTROL BLOCK               00653
BUIDD4   STH   R6,DSLENG      PUT LENGTH IN                             00654
         BCTR  R6,0           -1                                        00655
         EX    R6,*+4                                                   00656
         MVC   DSNAME(1),0(R5)     MOVE IN DSNAME                       00657
         LA    R15,4          RC=4 INCASE                               00658
         TM    6(R3),X'40'    DSNAME QUALIFIED                          00659
         BO    BUIDD5          YUP                                      00660
         SR    R15,R15        RC=0  SIMPLE QUALIFIER                    00661
         LTR   R2,R2          ANY QUALIFIER                             00662
         BZ    BUIDD4C                                                  00663
         LA    R5,DSNAME+1(R6)                                          00664
         MVI   0(R5),C'.'     ADD A PERIOD                              00665
         BCTR  R2,0           -1  (LENGTH OF QUAL)                      00666
         EX    R2,*+4                                                   00667
         MVC   1(1,R5),0(R1)  ADD  QUALIFIER                            00668
         LA    R6,3(R6,R2)     TOTAL LENGTH INCL PERIOD                 00669
         STH   R6,DSLENG      RESET LENGTH                              00670
BUIDD4C  OI    DA08CTL,DA08UID     APEND USER NAME                      00671
*              MEMBER NAME                                              00672
BUIDD5   TM    14(R3),X'80'   ANY                                       00673
         BZ    BUIDD6         NO                                        00674
         L     R5,8(R3)       R5=NAME                                   00675
         LH    R6,12(R3)      R6=LENGTH                                 00676
         BCTR  R6,0                                                     00677
         EX    R6,*+4         MOVE IT                                   00678
         MVC   DA08MNM(1),0(R5)    MOVE IT                              00679
*              PASSWORD                                                 00680
BUIDD6   TM    22(R3),X'80'   ANY?                                      00681
         BZ    BUIDD7         NO                                        00682
         L     R5,16(R3)      ADDR                                      00683
         LH    R6,20(R3)      LENGTH                                    00684
         BCTR  R6,0           -1                                        00685
         EX    R6,*+4                                                   00686
         MVC   DA08PSWD(1),0(R5)                                        00687
BUIDD7   DS    0H                                                       00688
         RETURN  (14,12),RC=(15)                                        00689
         DROP  R9,R7                                                    00690
         TITLE 'BUILD DAIR CONTROL BLOCKS'                              00691
*              R0  NUMBER OF BLOCKS TO BUILD                            00692
*              R1  DAPL                                                 00693
*              R11  CPPL                                                00694
BUILDAIR SAVE  (14,12)                                                  00695
         LA    R0,(SYSEND-DDNAMES)/8    NUMBER OF BLOCKS TO BUILD       00696
         LR    R10,R1         SAVE PL                                   00697
         USING DAPL,R10                                                 00698
         MVC   DAPLUPT,CPPLUPT     UPT                                  00699
         MVC   DAPLECT,CPPLECT     ECT                                  00700
         LA    R1,ECB                                                   00701
         ST    R1,DAPLECB     ECB                                       00702
         MVC   DAPLPSCB,CPPLPSCB   PSCB                                 00703
         LR    R2,R0          R2=COUNT                                  00704
         SLL   R0,2           * ENTRIES * 4                             00705
         LA    R1,DA28OPTR-DAPB28                                       00706
         AR    R0,R1                                                    00707
         GETMAIN              R,LV=(0)                                  00708
         ST    R1,DAPLDAPB                                              00709
         ST    R1,@DAIR28                                               00710
*              BEGIN INIT OF DAPB28                                     00711
         LR    R10,R1                                                   00712
         USING DAPB28,R10     DONE WITH PARM LIST                       00713
         MVC   DA28CD,=X'0028'  DO A LIST OF THINGS                     00714
         STH   R2,DA28NOP     THIS MANY                                 00715
         XC    DA28PFOP,DA28PFOP                                        00716
         SPACE 2                                                        00717
*              LOOP TO INIT ALL DAIR BLOCKS                             00718
*              INIT FOR TYPE 8 CALL EXCEPT                              00719
*              FOR CODE WHICH IS SET TO 28 (NOP)                        00720
         LR    R4,R2          R4   #ENTRIES                             00721
*                             R10  DAPB028                              00722
BUID1    GETMAIN  R,LV=130                                              00723
         ST    R1,DA28OPTR    ENTRY LIST                                00724
         USING DAPB08,R1                                                00725
         XC    DAPB08(130),DAPB08  CLEAR IT                             00726
         MVC   DA08CD,=X'0028'     NOP                                  00727
         LA    R3,DAPB08+84        ADDR OF DSNAME                       00728
         USING DSNBUF,R3                                                00729
         ST    R3,DA08PDSN    SAVE DSNAME ADDR                          00730
         MVI   DSNAME,C' '    LENGTH ALREADY ZERO BLANK OUT             00731
         MVC   DSNAME+1(43),DSNAME DSNAME                               00732
         DROP  R3                                                       00733
         MVC   DA08DDN,BLANKS                                           00734
         MVC   DA08UNIT,BLANKS                                          00735
         MVC   DA08SER,BLANKS                                           00736
         MVC   DA08MNM,BLANKS                                           00737
         MVC   DA08PSWD,BLANKS                                          00738
         MVC   DA08ALN,BLANKS                                           00739
         DROP  R1                                                       00740
         LA    R10,DAPB28+4  NEXT ENTRY IF ANY                          00741
         BCT   R2,BUID1       AND LOOP                                  00742
         RETURN    (14,12),T  AND BACK                                  00743
         SPACE 4                                                        00744
FAIL     ABEND 1,DUMP                                                   00745
         SPACE 2                                                        00746
QUIT     LA    1,20           HIGH CODE                                 00747
         ST    1,RETCODE                                                00748
         SPACE 1                                                        00749
EXIT     L     R6,4(13)  PREVIOUS SAVE AREA                             00750
         MVC   16(4,R6),RETCODE  RETURN SETS CODE                       00751
         FREEMAIN             R,LV=WKAL,A=(R13)                         00752
         LR    R13,R6                                                   00753
         RETURN   (14,12)                                               00754
         TITLE 'PLIF PROMPTER  FREE DAIR CONTROL BLOCK'                 00755
FREEDAIR SAVE  (14,12)                                                  00756
*              NO INPUT PARMS                                           00757
*              @DAIR28 IS THE STARTING POINT                            00758
         L     R10,@DAIR28                                              00759
         USING DAPB28,R10                                               00760
         LH    R2,DA28NOP     NUMBER OF ENTRIES                         00761
FRDR1    L     R9,DA28OPTR    GET IT                                    00762
         FREEMAIN   R,LV=130,A=(R9)                                     00763
         LA    R10,DAPB28+4   TO NEXT                                   00764
         BCT   R2,FRDR1                                                 00765
         L     R10,@DAIR28    MAIN BLOCK AGAIN                          00766
         LH    R0,DA28NOP     #OPER                                     00767
         SLL   R0,2           *4                                        00768
         LA    R1,DA28OPTR-DAPB28                                       00769
         AR    R0,R1          TOTAL LENGTH                              00770
         FREEMAIN    R,LV=(0),A=(R10)                                   00771
         DROP  R10                                                      00772
         RETURN    (14,12),T                                            00773
         TITLE 'EASY KEY - ROUTINE TO SET EASY KEYWORDS'                00774
EASYKEY  SAVE  (14,12)                                                  00775
*                             R1 FIRST PCE                              00776
*                             PDE ASSUMED DIRECTLY ADDRESSABLE          00777
         USING PDL,R10        R10 == PDL                                00778
         LR    R9,R1          GET IT OUT OF THE WAY                     00779
         SR    R2,R2          CLEAR R2                                  00780
EK1      DS    0H             TOP OF LOOP                               00781
         MVC   SCRATCH(6),0(R9)   GET PCE ON BOUNDARY                   00782
         NI    SCRATCH,B'11100000'   LENGTH ONLY                        00783
         CLI   SCRATCH,B'01000000' KEY WORD?                            00784
         BE    EK5            YUP                                       00785
         CLI   SCRATCH,0      END OF LIST                               00786
         BE    RETURN         YES ALL DONE                              00787
         BAL   R14,FAIL       OOPS MUST HAVE ONLY KEYWORDS              00788
EK5      LH    R7,SCRATCH+4   DISP OF CORRESPONDING PDE                 00789
         LH    R8,PDL(R7)     VALUE  R8 = BCT COUNT                     00790
EK10     AH    R9,SCRATCH+2   PDE LENGTH - STEPS TO NEXT                00791
         MVC   SCRATCH(8),0(R9)    BOUNDARY                             00792
         NI    SCRATCH,B'11100000' GET ID                               00793
         CLI   SCRATCH,B'01100000' NAME?                                00794
         BE    EK15           YUP                                       00795
         LTR   R8,R8          ARE WE JUST SCANING?                      00796
         BNP   EK1            YUP GO TO TOP                             00797
         BAL   R14,FAIL       OOPS - NOT OUR KIND                       00798
         SPACE 2                                                        00799
EK15     TM    0(R9),4        HAVE A SUBFIELD                           00800
         BZ    EK16           NO                                        00801
         SR    R8,R8          IF SO THEN WE DON'T DO IT HERE            00802
         B     EK10                                                     00803
         SPACE 1                                                        00804
EK16     BCT   R8,EK10        STEP TO NEXT UNTIL REACH VALUE            00805
         LA    R1,5(R9)       GET KEYWORD NAME                          00806
         IC    R2,4(R9)       GET LENGTH-1 OF KEYWORD                   00807
         BAL   R14,APEND      GO ADD IT                                 00808
         BCT   R8,EK10        R8-1 SCAN FOR NEXT KEYWORD                00809
         BAL   R14,FAIL       CAN'T GET HERE                            00810
RETURN   RETURN               (14,12)                                   00811
         DROP  R10                                                      00812
         TITLE 'APEND ROUTINE'                                          00813
*              APEND  - MOVE KEYWORD POINTED TO BY R1 AND               00814
*              LENGTH-1 IN R2 INTO PARMS  R15 LOST                      00815
APEND    LH    R15,PARMS      LENGTH CURRENTLY                          00816
         LTR   R15,R15        ZERO IS SPECIAL CASE                      00817
         LA    R15,PARMS+2(R15)                                         00818
         BZ    *+12           DON'T MOVE COMMA IF THIS IS FIRST         00819
         MVI   0(R15),C','     MOVE IN COMMA                            00820
         LA    R15,1(R15)     BUMP FOR COMMA                            00821
APEND2   EX    R2,*+4         MOVE IT                                   00822
         MVC   0(1,R15),0(R1)                                           00823
         LA    R15,1(R15,R2)  BUMP                                      00824
         S     R15,PARMADDR   NEW LENGTH                                00825
         SH    R15,=H'2'      DOWN BY TWO                               00826
         STH   R15,PARMS       AND BACK IN                              00827
         BR    R14            RETURN                                    00828
         SPACE 2                                                        00829
APENDC   LH    R15,PARMS      ENTRY FOR NO COMMA INSERT                 00830
         LA    R15,PARMS+2(R15)    FIRST AVAIL BYTE                     00831
         B     APEND2                                                   00832
PLIF      CSECT                                                         00833
OLDNEW   SAVE  (14,12)                                                  00834
*              R9=DAPB08                                                00835
         USING DAPB08,R9                                                00836
         LA    R7,DAIR04                                                00837
         USING DAPB04,R7                                                00838
         LA    R1,DAIRPL                                                00839
         USING DAPL,R1                                                  00840
         ST    R7,DAPLDAPB    FIX UP DAIR PARM BLOCK                    00841
         DROP  R1                                                       00842
*              INITIALIZE 04 CONTROL BLOCK                              00843
         XC    DAPB04(16),DAPB04                                        00844
         MVC   DA04CD,=X'0004'                                          00845
         MVC   DA04PDSN,DA08PDSN                                        00846
         MVC   DA04CTL,DA08CTL                                          00847
         ST R13,SAVE2+4                                                 00848
         LA    R13,SAVE2      NEW SAVE AREA                             00849
         LINK  EP=IKJDAIR                                               00850
         L     R13,4(R13)     OLD SAVE AREA                             00851
         LTR   R15,R15                                                  00852
         BZ    OLDNEW5                                                  00853
         CH    R15,=H'8'      RC=8                                      00854
         BNE   DAIR4          OOPS                                      00855
         CLC   DA04CTRC,=H'8'   NOT FOUND                               00856
         BNE   DAIR4          OOPS                                      00857
         OI    DA08DSP1,DA08NEW     ASSUME IT IS NEW                    00858
         OI    DA08DPS2,DA08CAT                                         00859
         OI    DA08DPS3,DA08CAT                                         00860
OLDNEW5  RETURN  (14,12),T                                              00861
         DROP  R7,R9                                                    00862
         TITLE 'PLIF PROMPTER SET DDNAMES'                              00863
SETDDNAM SAVE  (14,12)                                                  00864
         L     R7,@DAIR28                                               00865
         USING DAPB28,R7                                                00866
         LH    R2,DA28NOP     NUMBER OF OPERATIONS                      00867
         LA    R3,DDNAMES+2    FIRST DDNAME                             00868
         LR    R0,R2          GET LIST LENGTH                           00869
         SLL   R0,3           *8                                        00870
         STH   R0,DDNAMES     PUT IT IN                                 00871
STDD1    XC    0(8,R3),0(R3)                                            00872
         L     R9,DA28OPTR    GET BLOCK                                 00873
         USING DAPB08,R9                                                00874
         CLC   DA08CD,=X'0008'  TYTPE 8                                 00875
         BNE   STDD3          NO                                        00876
         MVC   0(8,R3),DA08DDN                                          00877
         B     STDD6                                                    00878
         USING DAPB1C,R9                                                00879
STDD3    CLC   DA1CCD,=X'001C'                                          00880
         BNE   STDD4                                                    00881
         MVC   0(8,R3),DA1CDDN                                          00882
         B     STDD6                                                    00883
         USING DAPB30,R9                                                00884
STDD4    CLC   DA30CD,=X'0030'                                          00885
         BNE   STDD5                                                    00886
         MVC   0(8,R3),DA30DDN                                          00887
STDD5    DS    0H                                                       00888
STDD6    LA    R7,DAPB28+4    BUMP                                      00889
         LA    R3,8(R3)                                                 00890
         BCT   R2,STDD1                                                 00891
         RETURN               (14,12),T                                 00892
         LTORG                                                          00893
         TITLE 'CONSTANTS'                                              00894
BLANKS   DC    CL8' '                                                   00895
         SPACE 4                                                        00896
         TITLE 'PLIF PROMPTER   MESSAGES                           '    00897
MSG001   PUTLINE  OUTPUT=(MSG001T,,DATA),MF=L                           00898
MSG001T  DC    AL2(MSG001E-*,0)                                         00899
         DC    C'LIB OPERAND REQUIRED IF MACRO SPECIFIED'               00900
MSG001E  EQU   *                                                        00901
         SPACE 2                                                        00902
MSG002   PUTLINE OUTPUT=(MSG002T,,DATA),MF=L                            00903
MSG002T  DC    AL2(MSG002E-*,0),C'LIB AND NOMACRO SPECIFIED'            00904
MSG002E  EQU                  *                                         00905
         SPACE 2                                                        00906
MSG003   PUTLINE OUTPUT=(MSG003T,,DATA),MF=L                            00907
MSG003T  DC    AL2(MSG003E-*,0)                                         00908
         DC    C'LOAD(DSN) REQUIRED WHEN SYSIN IS NOT SIMPLE NAME'      00909
MSG003E  EQU   *                                                        00910
         SPACE 2                                                        00911
MSG004   PUTLINE   OUTPUT=(MSG004T,,DATA),MF=L                          00912
MSG004T  DC    AL2(MSG004E-*,0)                                         00913
         DC    C'PRINT(DSN) REQUIRED WHEN SYSIND IS NOT SIMPLE NAME'    00914
MSG004E  EQU   *                                                        00915
         SPACE 2                                                        00916
MSG005   PUTLINE  OUTPUT=(MSG005T,,DATA),MF=L                           00917
MSG005T  DC    AL2(MSG005E-*,0)                                         00918
         DC    C'BOTH PUNCH SYSOUT CLASS AND MACRO DSN SPECIFIED'       00919
MSG005E  EQU   *                                                        00920
MSG006   PUTLINE  OUTPUT=(MSG006T,,DATA),MF=L                           00921
MSG006T  DC    AL2(MSG006E-*,0)                                         00922
         DC    C'PUNCH(DSN) REQUIRED WHEN SYSIN IS NOT SIMPLE NAME'     00923
MSG006E  EQU   *                                                        00924
         SPACE 2                                                        00925
         DS    0F             BOUNDARY ALIGNMENT                        00926
MSG007   DC    AL2(L'MSG007T+4,0)                                       00927
MSG007T  DC    C'  PL/I (F) CALLED  PARM='                              00928
         SPACE 2                                                        00929
         DS    0F             BOUNDARY ALIGNMENT                        00930
MSG008   DC    AL2(L'MSG008T+4,0)                                       00931
MSG008T  DC    C' HIGHEST ERROR CODE WAS '                              00932
         SPACE 2                                                        00933
MSG009   PUTLINE  OUTPUT=(MSG009T,,DATA),MF=L                           00934
MSG009T  DC    AL2(MSG009E-*,0)                                         00935
         DC    C'NO MORE THAN THREE MACRO LIBRARIES ALLOWED'            00936
MSG009E  EQU   *                                                        00937
         LTORG                                                          00938
         TITLE  'PLIF   PARSE PARAMETER LIST'                           00939
         PRINT ON,NOGEN                                                 00940
PLIFPARM IKJPARM DSECT=PDL                                              00941
DSIN     IKJPOSIT DSNAME,PROMPT='DATA SET NAME'                         00942
PRINT    IKJKEYWD DEFAULT='PRINT'                                       00943
         IKJNAME   'PRINT',SUBFLD=PRINTFLD                              00944
         IKJNAME   'SYSPRINT',SUBFLD=SOUTFLDA                           00945
PUNCH    IKJKEYWD                                                       00946
         IKJNAME   'DECK',SUBFLD=PUNCHFLD                               00947
         IKJNAME   'D'   ,SUBFLD=PUNCHFLD                               00948
         IKJNAME   'NODECK'                                             00949
         IKJNAME   'ND'                                                 00950
         IKJNAME   'SYSPUNCH',SUBFLD=SOUTFLDB                           00951
LIB      IKJKEYWD                                                       00952
         IKJNAME    'LIB',SUBFLD=LIBFLD                                 00953
         SPACE 4                                                        00954
*        BEGINNING OF PLI OPTIONS                                       00955
PLIFPARM CSECT                                                          00956
PCEFIRST EQU   *                                                        00957
PLIF     CSECT                                                          00958
         SPACE 2                                                        00959
         SPACE 2                                                        00960
*              CONTROL OPTIONS                                          00961
SIZEPARM IKJKEYWD                                                       00962
         IKJNAME  'SIZE',SUBFLD=SIZEFLD                                 00963
OPTPARM  IKJKEYWD                                                       00964
         IKJNAME  'OPT',SUBFLD=OPTFLD                                   00965
         IKJNAME  'O',SUBFLD=OPTFLD                                     00966
STMT     IKJKEYWD                                                       00967
         IKJNAME  'STMT'                                                00968
         IKJNAME  'ST'                                                  00969
         IKJNAME  'NOSTMT'                                              00970
         IKJNAME  'NST'                                                 00971
OBJNMPRM IKJKEYWD                                                       00972
         IKJNAME  'OBJNM',SUBFLD=OBJNMFLD                               00973
         IKJNAME  'N',SUBFLD=OBJNMFLD                                   00974
EXTDIC   IKJKEYWD                                                       00975
         IKJNAME  'EXTDIC'                                              00976
         IKJNAME  'ED'                                                  00977
         IKJNAME  'NOEXTDIC'                                            00978
         IKJNAME   'NED'                                                00979
SYNCHK   IKJKEYWD                                                       00980
         IKJNAME  'SYNCHKT'                                             00981
         IKJNAME  'SKT'                                                 00982
         IKJNAME  'SYNCHKS'                                             00983
         IKJNAME  'SKS'                                                 00984
         IKJNAME  'SYNCHKE'                                             00985
         IKJNAME  'SKE'                                                 00986
         SPACE   2                                                      00987
*              PREPROCESSER OPTIONS                                     00988
MACRO    IKJKEYWD                                                       00989
         IKJNAME  'MACRO'                                               00990
         IKJNAME  'M'                                                   00991
         IKJNAME  'NOMACRO'                                             00992
         IKJNAME  'NM'                                                  00993
COMP     IKJKEYWD                                                       00994
         IKJNAME  'COMP'                                                00995
         IKJNAME  'C'                                                   00996
         IKJNAME  'NOCOMP'                                              00997
         IKJNAME  'NC'                                                  00998
MACDCK   IKJKEYWD                                                       00999
         IKJNAME  'MACDCK',SUBFLD=PUNCHFLD                              01000
         IKJNAME  'MD',SUBFLD=PUNCHFLD                                  01001
         IKJNAME  'NOMACDK'                                             01002
         IKJNAME  'NMD'                                                 01003
         SPACE  2                                                       01004
*              INPUT  OPTIONS                                           01005
CHAR     IKJKEYWD                                                       01006
         IKJNAME  'CHAR48'                                              01007
         IKJNAME  'C48'                                                 01008
         IKJNAME  'CHAR60'                                              01009
         IKJNAME  'C60'                                                 01010
BCD      IKJKEYWD                                                       01011
         IKJNAME  'BCD'                                                 01012
         IKJNAME  'B'                                                   01013
         IKJNAME  'EBCDIC'                                              01014
         IKJNAME  'EB'                                                  01015
SMPARM   IKJKEYWD                                                       01016
         IKJNAME  'SORMGIN',SUBFLD=SMFLD                                01017
         IKJNAME  'SM',SUBFLD=SMFLD                                     01018
         SPACE    2                                                     01019
*              OUTPUT OPTIONS                                           01020
LOAD     IKJKEYWD  DEFAULT='LOAD'                                       01021
         IKJNAME  'LOAD',SUBFLD=GOFLD                                   01022
         IKJNAME  'LD',SUBFLD=GOFLD                                     01023
         IKJNAME  'NOLOAD'                                              01024
         IKJNAME  'NLD'                                                 01025
*              LISTING  OPTIONS                                         01026
LCPARM   IKJKEYWD                                                       01027
         IKJNAME  'LINECNT',SUBFLD=LCFLD                                01028
         IKJNAME  'LC',SUBFLD=LCFLD                                     01029
OPLIST   IKJKEYWD                                                       01030
         IKJNAME  'OPLIST'                                              01031
         IKJNAME  'OL'                                                  01032
         IKJNAME  'NOOPLIST'                                            01033
         IKJNAME  'NOL'                                                 01034
SOURCE2  IKJKEYWD                                                       01035
         IKJNAME  'SOURCE2'                                             01036
         IKJNAME  'S2'                                                  01037
         IKJNAME  'NOSOURCE2'                                           01038
         IKJNAME  'NS2'                                                 01039
SOURCE   IKJKEYWD                                                       01040
         IKJNAME  'SOURCE'                                              01041
         IKJNAME  'S'                                                   01042
         IKJNAME  'NOSOURCE'                                            01043
         IKJNAME  'NS'                                                  01044
NEST     IKJKEYWD                                                       01045
         IKJNAME  'NEST'                                                01046
         IKJNAME  'NT'                                                  01047
         IKJNAME  'NONEST'                                              01048
         IKJNAME  'NNT'                                                 01049
ATR      IKJKEYWD                                                       01050
         IKJNAME  'ATR'                                                 01051
         IKJNAME  'A'                                                   01052
         IKJNAME  'NOATR'                                               01053
         IKJNAME  'NA'                                                  01054
XREF     IKJKEYWD                                                       01055
         IKJNAME  'XREF'                                                01056
         IKJNAME  'X'                                                   01057
         IKJNAME  'NOXREF'                                              01058
         IKJNAME  'NX'                                                  01059
EXTREF   IKJKEYWD                                                       01060
         IKJNAME  'EXTREF'                                              01061
         IKJNAME  'E'                                                   01062
         IKJNAME  'NOEXTREF'                                            01063
         IKJNAME  'NE'                                                  01064
LIST     IKJKEYWD                                                       01065
         IKJNAME  'LIST'                                                01066
         IKJNAME  'L'                                                   01067
         IKJNAME  'NOLIST'                                              01068
         IKJNAME  'NL'                                                  01069
FLAG     IKJKEYWD                                                       01070
         IKJNAME  'FLAGW'                                               01071
         IKJNAME  'FW'                                                  01072
         IKJNAME  'FLAGE'                                               01073
         IKJNAME  'FE'                                                  01074
         IKJNAME  'FLAGS'                                               01075
         IKJNAME  'FS'                                                  01076
SIZEFLD  IKJSUBF                                                        01077
SIZE     IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,                *01078
               PROMPT='CORE SIZE'                                       01079
LIBFLD   IKJSUBF                                                        01080
DSLIB    IKJPOSIT  DSNAME,LIST,PROMPT='MACRO LIBRARY NAME'              01081
GOFLD    IKJSUBF                                                        01082
DSGO     IKJPOSIT  DSNAME                                               01083
PUNCHFLD IKJSUBF                                                        01084
DSPUNCH  IKJPOSIT  DSTHING                                              01085
SOUTFLDB IKJSUBF                                                        01086
SYSOUTB  IKJIDENT  'CLASS',FIRST=ALPHA,MAXLNTH=1,DEFAULT='B'            01087
SYSOUTBP IKJIDENT       'COPYX',OTHER=ALPHANUM,MAXLNTH=8                01088
SYSOUTBF IKJIDENT    'FORM NUMBER',FIRST=ANY,OTHER=ANY,MAXLNTH=4        01089
OPTFLD   IKJSUBF                                                        01090
OPT      IKJIDENT 'OPTIMIZATION LEVEL',MAXLNTH=1,FIRST=NUMERIC,        *01091
               PROMPT='OPTIMIZATION LEVEL 0 1 OR 2'                     01092
OBJNMFLD IKJSUBF                                                        01093
OBJNM    IKJIDENT 'NAME',OTHER=ALPHANUM,MAXLNTH=8,                   * *01094
               PROMPT='LOAD MODULE NAME'                                01095
SMFLD    IKJSUBF                                                        01096
SM1      IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,DEFAULT='2'      01097
SM2      IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,DEFAULT='72'     01098
SM3      IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,DEFAULT='1'      01099
LCFLD    IKJSUBF                                                        01100
LINECNT  IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,                *01101
               PROMPT='NUMBER OF LINES PER PAGE'                        01102
PRINTFLD IKJSUBF                                                        01103
DSPRINT IKJPOSIT  DSTHING                                               01104
SOUTFLDA IKJSUBF                                                        01105
SYSOUTA  IKJIDENT  'CLASS',FIRST=ALPHA,MAXLNTH=1,DEFAULT='A'            01106
SYSOUTAP IKJIDENT  'COPYX',OTHER=ALPHANUM,MAXLNTH=8                     01107
SYSOUTAF IKJIDENT             'FORM NUMBER',MAXLNTH=4,DEFAULT='10',    *01108
               FIRST=ANY,OTHER=ANY                                      01109
         IKJENDP                                                        01110
         PRINT ON,GEN                                                   01111
         TITLE 'PLIF PROMPTER   DSECTS'                                 01112
SAVE     DSECT                                                          01113
         DS    18A                                                      01114
RETCODE  DS    A                                                        01115
SCRATCH  DS    D              WORK AREA                                 01116
@PDE     DS    A                                                        01117
@DAIR28  DS    A                                                        01118
ECB      DS    A                                                        01119
SIMPLE   DS    2A                                                       01120
PARSEPL  DS    7A                                                       01121
DAIRPL   DS    7A                                                       01122
DAIR04   DS    4A                                                       01123
FLAGS    DS    X                                                        01124
PTPL     DS    4A                                                       01125
AOUT     DS    C                                                        01126
BOUT     DS    C                                                        01127
ENDSAVE  EQU   *                                                        01128
SAVE2    DS    18A            SECOND WORK AREA                          01129
         ORG   SAVE2                                                    01130
DDNAMES  DC    H'48'          PLIF ASM                                  01131
SYSLIN   DC    XL8'0'         YES  NO       SAME AS SYSGO               01132
SYSLIB3  DC    XL8'0'         NO   NO                                   01133
SYSLIB2  DC    XL8'0'         NO   NO                                   01134
SYSLIB   DC    XL8'0'         YES  YES      MACRO                       01135
SYSIN    DC    XL8'0'         YES  YES      INPUT SOURCE                01136
SYSPRINT DC    XL8'0'         YES  YES      OUTPUT                      01137
SYSPUNCH DC    XL8'0'         YES  YES      PUNCH OUTPUT                01138
SYSUT1   DC    XL8'0'         YES  YES      WORK                        01139
SYSUT2   DC    XL8'0'         NO   YES      WORK                        01140
SYSUT3   DC    XL8'0'         YES  YES      WORK                        01141
SYSGO    DC    XL8'0'         NO   YES      OBJ SAME AS SYSLIN          01142
SYSTERM  DC    XL8'0'         NO   YES      ERROR MESSAGES              01143
SYSEND   EQU   *                                                        01144
         SPACE 2                                                        01145
PARMADDR DC    A(PARMS)                                                 01146
         DC    X'80',AL3(DDNAMES)                                       01147
         DC    H'0'           HALFWORD USED AS PARM-2 FOR PUTLINE       01148
PARMS    DC    H'0',CL252' '                                            01149
NO       EQU   B'00'                                                    01150
MIX      EQU   B'01' OR B'10'                                           01151
YES      EQU   B'11'                                                    01152
SPMAC    DC    AL1(MIX)                                                 01153
SPMD     DC    AL1(MIX)                                                 01154
SPLIB    DC    AL1(MIX)                                                 01155
SPD      DC    AL1(NO)                                                  01156
WKAL     EQU   *-SAVE                                                   01157
         SPACE 4                                                        01158
DSNBUF   DSECT                                                          01159
DSLENG   DS    H                                                        01160
DSNAME   DS    CL44                                                     01161
         EJECT                                                          01162
         IKJPPL                                                         01163
         SPACE 4                                                        01164
         IKJCPPL                                                        01165
         SPACE 4                                                        01166
         IKJDAPL                                                        01167
         IKJIOPL                                                        01168
         EJECT                                                          01169
         IKJDAP04                                                       01170
         SPACE 4                                                        01171
         IKJDAP30                                                       01172
         EJECT                                                          01173
         SPACE 4                                                        01174
         IKJDAP0C                                                       01175
DA0CDDN  DS    CL8            MISSING POINTER FROM MACRO                01176
         SPACE 4                                                        01177
         IKJDAP08                                                       01178
         EJECT                                                          01179
         SPACE 4                                                        01180
         IKJDAP1C                                                       01181
         SPACE 4                                                        01182
         IKJDAP28                                                       01183
DA28OPTR DS    A              MISSING POINTER FROM FIELD                01184
         SPACE 4                                                        01185
         IKJDAP18                                                       01186
         EJECT                                                          01187
         REGEQU                                                         01188
         END                                                            01189
